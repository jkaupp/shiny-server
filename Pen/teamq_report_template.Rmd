---
title: "TeamQ Report"
output: pdf_document
---

```{r setup, include = FALSE}

library(tidyverse)
library(janitor)
library(magrittr)
library(knitr)
library(pander)
library(stringr)
library(stringi)
library(digest)
library(ggradar)
library(jkmisc)

knitr::opts_chunk$set(echo = TRUE)

 teamq <- tibble(question = 1:15, 
                  scales =c(rep("Contributes to Team Project", 3),rep("Facilitates Contibutions of Others",3),rep("Planning and Management",3),rep("Fosters a Team Climate",2),rep("Manages Potential Conflict",3),"Suggestions to Improve"),
                  items = c("Participates Actively and Accepts a Fair Share of the Group Work", 
             "Works Skillfully on Assigned Tasks and Completes Them on Time", 
             "Gives Timely, Constructive Feedback to Team Members, in the Appropriate Format", 
             "Communicates Actively and Constructively", "Encourages All Perspective be Considered and Acknowledges Contributions of Others", 
             "Constructively Builds on Contributions of Others and Integrates Own Work with Work of Others", 
             "Takes on an Appropriate Role in Group (E.g. Leader, Note Taker)", 
             "Clarifies Goals and Plans the Project", "Reports to Team on Progress", 
             "Ensures Consistency Between Words, Tone, Facial Expression and Body Language", 
             "Expresses Positivity and Optimism About Team Members and Project", 
             "Displays Appropriate Assertiveness: Neither Dominating, Submissive, nor Passive Aggressive", 
             "Contributes Appropriately to Healthy Debate", "Responds to and Manages Direct/Indirect Conflict Constructively and Effectively",
             "Write one specific, actionable goal to help your teammate improve their teamwork competency"
  ))
  
```


```{r data}
data <- x %>%
    select_(~team, ~reviewer_last_name, ~reviewer_first_name, ~reviewee_last_name, ~reviewee_first_name, ~contains("q")) %>% 
    unite(reviewer_name, reviewer_first_name, reviewer_last_name, sep = " ") %>% 
    unite(reviewee_name, reviewee_first_name, reviewee_last_name, sep = " ") %>% 
    # mutate(reviewee_name = factor(reviewee_name,levels = unique(reviewee_name))) %>% 
    # mutate(reviewer_name = factor(reviewer_name,levels = unique(reviewer_name))) %>% 
    mutate_at("q15", funs(stri_replace_all_regex(., "[\r]" , ""))) %>% 
    mutate_at("q15", funs(stri_replace_all_regex(., "[^[:alnum:]]", " "))) %>%
    # mutate_if(is.numeric, function(x) factor(x, 1:5, c("Never","Sometimes","Ususally","Regularly","Always"))) %>% 
    gather(question, value, contains("q")) %>% 
    mutate(question = parse_number(question)) %>% 
    left_join(teamq, by = "question") %>% 
    rename(To = reviewee_name,
           From = reviewer_name,
           team_number  = team)
```

Team-Q was developed for self and peer assessment of an individual's teamwork skills. It is designed for undergraduate education as a practical method for assessing teamwork as a learning outcome. The following describes teamwork behaviors, with students report on a five point scale how often their peers (and self) demonstrate each of the behaviors (Never, Sometimes, Usually, Regularly, Always). 

```{r spider}
test <- filter(data, To == "Sarah Chin")

others <- filter(test, To != From, question != 15) %>% 
  group_by(To, question) %>% 
  summarize(value = mean(as.numeric(value))) %>% 
  mutate(group = "others") %>% 
  spread(question, value)

own <- filter(test, To == From, question != 15) %>% 
  mutate(group = "own") %>% 
  select(To, group, question, value) %>% 
  spread(question, value) %>% 
  mutate_at(vars(-To, -group), funs(as.numeric))

plot_data <- bind_rows(own, others) 
  
plot_data %>%
  select(2:16) %>%
  ggradar(., 
          axis.labels = str_wrap(teamq$items[-15], 20),
          grid.min = 1,
          grid.mid = 3,
          grid.max = 5,
          group.point.size = 3,
          grid.line.width = 0.5,
          gridline.mid.colour = "grey",
          gridline.min.colour = "grey",
          gridline.max.colour = "grey",
          axis.line.colour = "grey",
          axis.label.size = 4,
          group.line.width = 1,
          values.radar = c("1","3","5"),
          font.radar = "Slabo 13px") +
  scale_color_manual(values = c("own" = "firebrick","others" = "dodgerblue")) +
  theme_jk(axis = FALSE, grid = FALSE) +
  theme(axis.text = element_blank(),
        panel.grid = element_blank())
```
